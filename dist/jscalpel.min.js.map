{"version":3,"file":"jscalpel.min.js","sources":["../index.js"],"sourcesContent":["const jscalpel = ({ target, keys, prefix, callback, deep, dynamicKeys, plugins}, defaultOpts) => {\r\n    const nativeToString = Object.prototype.toString;\r\n    let enablePrefix = prefix ? true : false;\r\n    const deepCopy = (obj) => {\r\n        const returnObj = {};\r\n        let tempArr = [];\r\n        if (nativeToString.call(obj) === '[object Object]') {\r\n            Object.keys(obj).forEach((key, index) => {\r\n                if (Array.isArray(obj[key])) {\r\n                    obj[key].forEach((value, index) => {\r\n                        tempArr.push(value);\r\n                    });\r\n                    returnObj[key] = tempArr;\r\n                    tempArr = [];\r\n                } else if (nativeToString.call(obj[key] === '[object Object]')) {\r\n                    returnObj[key] = deepCopy(obj[key]);\r\n                }\r\n            });\r\n            return returnObj;\r\n        } else {\r\n            return obj;\r\n        }\r\n    }\r\n    const autoCompleteKey = (key) => {\r\n        return (`${prefix && enablePrefix ? `${prefix}.${key}` : `${key}`}`);\r\n    }\r\n    const getParameterNames = (fn) => {\r\n        const COMMENTS = /((\\/\\/.*$)|(\\/\\*[\\s\\S]*?\\*\\/))/mg;\r\n        const DEFAULT_PARAMS = /=[^,]+/mg;\r\n        const FAT_ARROWS = /=>.*$/mg;\r\n        const code = fn.toString()\r\n            .replace(COMMENTS, '')\r\n            .replace(FAT_ARROWS, '')\r\n            .replace(DEFAULT_PARAMS, '');\r\n\r\n        const result = code.slice(code.indexOf('(') + 1, code.indexOf(')'))\r\n            .match(/([^\\s,]+)/g);\r\n\r\n        return result === null\r\n            ? []\r\n            : result;\r\n    }\r\n    let defaultValue = null;\r\n    let result = null;\r\n    let epTarget = null;\r\n    const cbParams = callback ? getParameterNames(callback) : [];\r\n    console.log('cbParams', cbParams);\r\n    let willPluginInfo = {};\r\n    if (typeof dynamicKeys === 'function') {\r\n        keys = dynamicKeys(keys) || keys;\r\n        enablePrefix = false;\r\n    }\r\n    try {\r\n        epTarget = typeof target === 'string' ? JSON.parse(target) : target;\r\n        if (deep) {\r\n            epTarget = deepCopy(epTarget);\r\n        }\r\n\r\n        if (nativeToString.call(epTarget) !== '[object Object]' && !Array.isArray(epTarget)) {\r\n            console.error('传入的target不是有效的json或者object');\r\n            return;\r\n        }\r\n    } catch (err) {\r\n        console.error('传入的target不是有效的json或者object');\r\n        return;\r\n    }\r\n    if (typeof keys === 'string' && keys.length > 0) {\r\n\r\n        `${autoCompleteKey(keys)}`.split('.').forEach((value, index) => {\r\n            result= (result ? result[value] : epTarget[value])\r\n            willPluginInfo = {\r\n                value: result,\r\n                name: cbParams[index]\r\n            };\r\n            if (plugins && Array.isArray(plugins)) {\r\n                plugins.forEach((plugin, index) => {\r\n                    result = plugin(willPluginInfo);\r\n                })\r\n            }\r\n        })\r\n        if (callback && typeof callback === 'function') {;\r\n            defaultValue = callback.call(null, result, epTarget, keys, defaultOpts);\r\n        } else {\r\n            defaultValue = callback;\r\n        }\r\n        if (typeof defaultValue === 'undefined') {\r\n            return result || defaultOpts;\r\n        }\r\n        return defaultValue;\r\n    } else if (nativeToString.call(keys) === '[object Array]') {\r\n        const pResult = [];\r\n        keys.forEach((singlePath, idx) => {\r\n            result = null;\r\n            if (typeof singlePath === 'string') {\r\n                `${autoCompleteKey(singlePath)}`.split('.').forEach((value, index) => {\r\n                    result= (result ? result[value] : epTarget[value])\r\n                });\r\n                willPluginInfo = {\r\n                    value: result,\r\n                    name: cbParams[idx]\r\n                }\r\n                if (plugins && Array.isArray(plugins)) {\r\n                    plugins.forEach((plugin, index) => {\r\n                        result = plugin(willPluginInfo);\r\n                    })\r\n                }\r\n                pResult.push(result);\r\n            }\r\n        })\r\n        pResult.push(epTarget,keys, defaultOpts);\r\n        if (callback && typeof callback === 'function') {\r\n            defaultValue = callback.apply(null, pResult);\r\n        } else {\r\n            defaultValue = callback;\r\n        }\r\n        if (typeof defaultValue === 'undefined') {\r\n            return pResult || defaultOpts;\r\n        }\r\n        return defaultValue;\r\n    }\r\n}\r\n\r\nexport default jscalpel;"],"names":["jscalpel","defaultOpts","target","keys","prefix","callback","deep","dynamicKeys","plugins","nativeToString","Object","prototype","toString","enablePrefix","deepCopy","obj","returnObj","tempArr","call","forEach","key","index","Array","isArray","value","push","autoCompleteKey","getParameterNames","fn","COMMENTS","DEFAULT_PARAMS","FAT_ARROWS","code","replace","result","slice","indexOf","match","defaultValue","epTarget","cbParams","log","willPluginInfo","JSON","parse","error","err","length","split","plugin","pResult","singlePath","idx","apply"],"mappings":"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"}